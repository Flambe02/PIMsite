/**
 * This configuration is used to for the Sanity Studio that's mounted on the `\app\studio\[[...tool]]\page.tsx` route
 */

// Configuration conditionnelle pour éviter les erreurs de build
const isProduction = process.env.NODE_ENV === 'production';

if (!isProduction) {
  // Import dynamique seulement en développement
  const {visionTool} = require('@sanity/vision');
  const {defineConfig} = require('sanity');
  const {structureTool} = require('sanity/structure');
  const {apiVersion, dataset, projectId} = require('./sanity/env');
  const {schema} = require('./sanity/schemaTypes');
  const {structure} = require('./sanity/structure');

  module.exports = defineConfig({
    basePath: '/studio',
    projectId,
    dataset,
    schema,
    plugins: [
      structureTool({structure}),
      visionTool({defaultApiVersion: apiVersion}),
    ],
  });
} else {
  // Configuration minimale pour la production
  module.exports = {
    basePath: '/studio',
    projectId: process.env.NEXT_PUBLIC_SANITY_PROJECT_ID || 'y5sty7n2',
    dataset: process.env.NEXT_PUBLIC_SANITY_DATASET || 'production',
    schema: {},
    plugins: [],
  };
} 